{% extends "base.html" %}
{% block title %}Visualizar EDI{% endblock %}

{% block menu.generar %}active{% endblock %}
{% block menu.generar.ver %}active{% endblock %}
{% block page.header %}Ver archivos EDI{% endblock %}
{% block page.content %}
<form role="form">

  <div class="example-modal">
  <div class="modal">
    <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span></button>
                <input type="text" class="form-control" id="input-fileName" value="{{ edi.BST03 }}-{{ edi.BST04 }}" placeholder="Enter file name">
              </div>
              <div class="modal-body">
{% if edi %}
<pre id="someid" style="max-height:300px; background:#fff"><span class="item">ISA*00*          *00*          *{{ edi.PREFIX_NAME }}*{{ edi.NAME }}   *{{ edi.PREFIX_CLIENT }}*{{ edi.CLIENT }}      *{{ edi.BST03 }}*{{ edi.BST04 }}*U*00401**0000000{{ edi.ST02 }}*0*T</span>
<span class="item">GS*SH*{{ edi.NAME }}*{{ edi.CLIENT }}*{{ edi.BST03 }}*{{ edi.BST04 }}*{{ edi.ST02 }}*X*04010</span>
<span class="item">ST*{{ edi.ST01 }}*{{ edi.ST02 }}</span>
BSN*{{ edi.BST01 }}*{{ edi.BST02 }}*{{ edi.BST03 }}*{{ edi.BST04 }}
DTM*{{ edi.DTM01 }}*{{ edi.BST03 }}*{{ edi.BST04 }}*{{ edi.DTM04 }}<br>&#13;{% if hl %}{% for header in hl %}HL*{{ header.HL01 }}*{{ header.HL02 }}*{{ header.HL03 }}<br>&#13;{% if header.HL03 == 'S' %}MEA*{{ edi.MEA01 }}*{{ edi.MEA02 }}*{{ edi.MEA03 }}*{{ edi.MEA04 }}
TD1*{{ edi.TD101 }}*{{ edi.TD102 }}
TD5*{{ edi.TD501 }}*{{ edi.TD502 }}*{{ edi.TD503 }}*{{ edi.TD504 }}
TD3*{{ edi.TD301 }}*{{ edi.TD302 }}*{{ edi.TD303 }}
REF*{{ edi.REF01 }}*{{ edi.REF02 }}
N1*SF**1*DUNS
N1*{{ edi.N101 }}*{{ edi.N103 }}*{{ edi.N104 }}
N1*{{ edi.N201 }}*{{ edi.N203 }}*{{ edi.N204 }}
N1*{{ edi.N301 }}*{{ edi.N303 }}*{{ edi.N304 }}{% elif header.HL03 == 'O' %}LIN**{{ header.LIN02 }}*{{ header.LIN03 }}
SN1**{{ header.SN102 }}*{{ header.SN103 }}*{{ header.SN104 }}
PRF*{{ header.PRF01 }}<br>&#13;REF*{{ header.REF101 }}*{{ header.REF102 }}<br>&#13;REF*{{ header.REF201 }}*{{ header.REF202 }}
{% for ord in order %}{% if ord.REF101 %}<br>&#13;REF*{{ ord.REF101 }}*{{ ord.REF102 }}{% endif %}{% if ord.REF201 %}<br>&#13;REF*{{ ord.REF201 }}*{{ ord.REF202 }}{% endif %}{% endfor %}{% elif header.HL03 == 'I' %}{% if header.MEA03 %}MEA*{{ header.MEA01 }}*{{ header.MEA02 }}*{{ header.MEA03 }}{% endif %}{% if header.MEA203 %}<br>&#13;MEA*{{ header.MEA201 }}*{{ header.MEA202 }}*{{ header.MEA203 }}{% endif %}{% if header.MEA303 %}<br>&#13;MEA*{{ header.MEA301 }}*{{ header.MEA302 }}*{{ header.MEA303 }}{% endif %}{% if header.MEA403 %}<br>&#13;MEA*{{ header.MEA401 }}*{{ header.MEA402 }}*{{ header.MEA403 }}{% endif %}REF*{{ header.REF_ITEM101 }}*{{ header.REF_ITEM102 }}<br>&#13;CLD*{{ header.CLD01 }}*{{ header.CLD02 }}*{{ header.CLD03 }}{% if header.REF_CLD102 %}<br>&#13;REF*{{ header.REF_CLD101 }}*{{ header.REF_CLD102 }}{% endif %}{% if header.REF_CLD202 %}<br>&#13;REF*{{ header.REF_CLD201 }}*{{ header.REF_CLD202 }}{% endif %}{% if header.REF_CLD302 %}<br>REF*{{ header.REF_CLD301 }}*{{ header.REF_CLD302 }}{% endif %}{% if header.REF_CLD402 %}
REF*{{ header.REF_CLD401 }}*{{ header.REF_CLD402 }}{% endif %}{% endif %}{% endfor %}{% endif %}</pre>{% endif %}
              </div>
              <div class="modal-footer">
                <a href="/crear/ver/" class="btn btn-default pull-left" data-dismiss="modal">Cancelar</a>
                <button id="btn-save" type="submit" class="btn btn-primary">Descargar Archivo</button>
              </div>
            </div>
          </div>
        </div>
      </div>
</form>


    </span>
    <span class="item"></span>
    <span class="item"></span>
    <span class="item"></span>
    <span class="item"></span>

<span id="liness">...</span>
{% endblock %}
{% block aditional.css %}
<style>
.modal .modal-body {
    max-height: 420px;
    overflow-y: auto;
}
    .example-modal .modal {
      position: relative;
      top: auto;
      bottom: auto;
      right: auto;
      left: auto;
      display: block;
      z-index: 1;
    }

    .example-modal .modal {
      background: transparent !important;
    }
  </style>
{% endblock %}
{% block aditional.js %}
{% load staticfiles %}<script src="{% static 'js/FileSaver.min.js' %}"></script>
<script>
$("#btn-save").click( function() {
  var text = $("#someid").text();
  var filename = $("#input-fileName").val()
  var blob = new Blob([text]);
  saveAs(blob, filename);
});</script>
<script>
document.getElementById("liness").innerHTML = '*' + $('.item').length + ' lines';
</script>
{% endblock %}